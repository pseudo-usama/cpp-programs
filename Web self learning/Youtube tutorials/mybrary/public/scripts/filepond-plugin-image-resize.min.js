(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self,e.FilePondPluginImageResize=t())})(this,function(){"use strict";var e=function(e){return/^image/.test(e.type)},t=function(e,t){var n=new Image;n.onload=function(){var e=n.naturalWidth,i=n.naturalHeight;n=null,t(e,i)},n.src=e},n=function(n){var i=n.addFilter,a=n.utils,o=a.Type;return i("DID_LOAD_ITEM",function(n,i){var a=i.query;return new Promise(function(i,o){var r=n.file;if(!e(r)||!a("GET_ALLOW_IMAGE_RESIZE"))return i(n);var u=a("GET_IMAGE_RESIZE_MODE"),l=a("GET_IMAGE_RESIZE_TARGET_WIDTH"),d=a("GET_IMAGE_RESIZE_TARGET_HEIGHT"),E=a("GET_IMAGE_RESIZE_UPSCALE");if(null===l&&null===d)return i(n);var f=null===l?d:l,s=null===d?f:d,c=URL.createObjectURL(r);t(c,function(e,t){URL.revokeObjectURL(c);var a=(n.getMetadata("exif")||{}).orientation||-1;if(a>=5&&a<=8){var o=[t,e];e=o[0],t=o[1]}return e===f&&t===s?i(n):e<=f&&t<=s&&!E?i(n):(n.setMetadata("resize",{mode:u,upscale:E,size:{width:f,height:s}}),void i(n))})})}),{options:{allowImageResize:[!0,o.BOOLEAN],imageResizeMode:["cover",o.STRING],imageResizeUpscale:[!0,o.BOOLEAN],imageResizeTargetWidth:[null,o.INT],imageResizeTargetHeight:[null,o.INT]}}},i="undefined"!=typeof window&&void 0!==window.document;return i&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:n})),n});